{"version":3,"sources":["../../server/middlewares/common.js"],"names":["common","app","use","ctx","next","start","Date","ms","console","log","method","url","on","err","logger","error"],"mappings":";;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEO,IAAMA,0BAAS,SAATA,MAAS,CAACC,GAAD,EAAQ;AAC1B,8BAAQA,GAAR;AACAA,QAAIC,GAAJ,CAAQ,8BAAR,EACIA,GADJ,CACQ,wBADR,EAEIA,GAFJ,CAEQ,0BAFR,EAGIA,GAHJ;AAAA,4FAGQ,iBAAOC,GAAP,EAAYC,IAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AACMC,iCADN,GACc,IAAIC,IAAJ,EADd;AAAA;AAAA,mCAEMF,MAFN;;AAAA;AAGMG,8BAHN,GAGW,IAAID,IAAJ,KAAaD,KAHxB;;AAIAG,oCAAQC,GAAR,CAAeN,IAAIO,MAAnB,SAA6BP,IAAIQ,GAAjC;;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAHR;;AAAA;AAAA;AAAA;AAAA,SASKC,EATL,CASQ,OATR,EASiB,UAACC,GAAD,EAAMV,GAAN,EAAc;AACvBK,gBAAQC,GAAR,CAAYI,GAAZ;AACAC,4BAAOC,KAAP,CAAa,cAAb,EAA6BF,GAA7B,EAAkCV,GAAlC;AACH,KAZL;AAaH,CAfM","file":"common.js","sourcesContent":["import json from 'koa-json'\r\nimport onerror from 'koa-onerror'\r\nimport bodyparser from 'koa-bodyparser'\r\nimport logger from 'koa-logger'\r\n\r\nexport const common = (app) =>{\r\n    onerror(app)\r\n    app.use(bodyparser())\r\n       .use(json())\r\n       .use(logger())\r\n       .use(async (ctx, next) => {\r\n            const start = new Date()\r\n            await next()\r\n            const ms = new Date() - start\r\n            console.log(`${ctx.method} ${ctx.url} - $ms`)\r\n        })\r\n        .on('error', (err, ctx) => {\r\n            console.log(err)\r\n            logger.error('server error', err, ctx)\r\n        })\r\n}"]}